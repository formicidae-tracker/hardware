#pragma once

#define EMC2302_1_I2C_ADDRESS 0x2e
#define EMC2302_2_I2C_ADDRESS 0x2f

#define EMC_CONFIG_REG 0x20
#define EMC_MASK 7
#define EMC_DISABLE_TIMEOUT 6
#define EMC_WATCHDOG_ENABLE 5
#define EMC_DRIVE_CLOCK_PIN 1
#define EMC_USE_EXTERNAL_CLOCK 0


#define EMC_FAN_STATUS_REGS 0x24
#define EMC_FAN_STATUS_REG 0x24
#define EMC_WD_EXPIRED 7
#define EMC_DRIVE_FAIL 2
#define EMC_FAN_SPIN 1
#define EMC_FAN_STALL 0

#define EMC_FAN_STALL_REG 0x25
#define EMC_FAN_SPIN_REG 0x26
#define EMC_FAN_DRV_FAIL_REG 0x27

#define EMC_FAN_INT_EN_REG 0x29


#define EMC_PWM_POL_REG 0x2a
#define EMC_PWM_OUT_REG 0x2b

#define EMC_PWM_FREQ_REG 0x2d

#define EMC_PWM_F1_26K 0x00
#define EMC_PWM_F1_19K 0x01
#define EMC_PWM_F1_4K 0x02
#define EMC_PWM_F1_2K 0x03

#define EMC_PWM_F2_26K (EMC_PWM_F1_26K << 2)
#define EMC_PWM_F2_19K (EMC_PWM_F1_19K << 2)
#define EMC_PWM_F2_4K (EMC_PWM_F1_4K << 2)
#define EMC_PWM_F2_2K (EMC_PWM_F1_2K << 2)

#define EMC_FAN1_PWM_DIV_REG 0x31
#define EMC_FAN2_PWM_DIV_REG 0x41

#define EMC_FAN1_SET_POINT_REG 0x30
#define EMC_FAN2_SET_POINT_REG 0x40

#define EMC_FAN1_CONF1_REG 0x32
#define EMC_FAN2_CONF1_REG 0x42

#define EMC_EN_ALGO  (1 << 7)
#define EMC_DIS_ALGO 0x00

#define EMC_RANGE_500  (0x00 << 5)
#define EMC_RANGE_1000 (0x01 << 5)
#define EMC_RANGE_2000 (0x02 << 5)
#define EMC_RANGE_4000 (0x03 << 5)

#define EMC_EDGES_3 (0x00 << 3)
#define EMC_EDGES_5 (0x01 << 3)
#define EMC_EDGES_7 (0x02 << 3)
#define EMC_EDGES_9 (0x04 << 3)

#define EMC_UPDATE_100MS  0x00
#define EMC_UPDATE_200MS  0x01
#define EMC_UPDATE_300MS  0x02
#define EMC_UPDATE_400MS  0x03
#define EMC_UPDATE_500MS  0x04
#define EMC_UPDATE_800MS  0x05
#define EMC_UPDATE_1200MS 0x06
#define EMC_UPDATE_1600MS 0x07


#define EMC_FAN1_CONF2_REG 0x33
#define EMC_FAN2_CONF2_REG 0x43

#define EMC_FAN1_GAIN_REG 0x35
#define EMC_FAN2_GAIN_REG 0x45

#define EMC_FAN1_SPIN_UP_REG 0x36
#define EMC_FAN2_SPIN_UP_REG 0x46

#define EMC_DRIVE_FAIL_COUNT_0 0
#define EMC_DRIVE_FAIL_COUNT_16 (1 << 6)
#define EMC_DRIVE_FAIL_COUNT_32 (2 << 6)
#define EMC_DRIVE_FAIL_COUNT_64 (3 << 6)

#define EMC_ENABLE_KICK 0
#define EMC_DISABLE_KICK (1 << 5)
#define EMC_SPIN_LVL_30 0
#define EMC_SPIN_LVL_35 (1 << 2)
#define EMC_SPIN_LVL_40 (2 << 2)
#define EMC_SPIN_LVL_45 (3 << 2)
#define EMC_SPIN_LVL_50 (4 << 2)
#define EMC_SPIN_LVL_55 (5 << 2)
#define EMC_SPIN_LVL_60 (6 << 2)
#define EMC_SPIN_LVL_65 (7 << 2)

#define EMC_SPIN_TIME_250MS (0)
#define EMC_SPIN_TIME_500MS (1)
#define EMC_SPIN_TIME_1000MS (2)
#define EMC_SPIN_TIME_2000MS (3)


#define EMC_FAN1_MAX_STEP_REG 0x37
#define EMC_FAN2_MAX_STEP_REG 0x47

#define EMC_FAN1_MIN_DRIVE_REG 0x38
#define EMC_FAN2_MIN_DRIVE_REG 0x48

#define EMC_FAN1_VALID_TACH_REG 0x39
#define EMC_FAN2_VALID_TACH_REG 0x49

#define EMC_FAN1_FAIL_BAND_REG_L 0x3a
#define EMC_FAN1_FAIL_BAND_REG_H 0x3b
#define EMC_FAN2_FAIL_BAND_REG_L 0x4a
#define EMC_FAN2_FAIL_BAND_REG_H 0x4b

#define EMC_FAN1_TACH_TARGET_REG_L 0x3c
#define EMC_FAN1_TACH_TARGET_REG_H 0x3d
#define EMC_FAN2_TACH_TARGET_REG_L 0x4c
#define EMC_FAN2_TACH_TARGET_REG_H 0x4d

#define EMC_FAN1_TACH_COUNT_REG_L 0x3f
#define EMC_FAN1_TACH_COUNT_REG_H 0x3e
#define EMC_FAN2_TACH_COUNT_REG_L 0x4f
#define EMC_FAN2_TACH_COUNT_REG_H 0x4e

#define EMC_SOFTWARE_LOCK_REG 0xef
#define EMC_EMABLE_SOFTWARE_LOCK 0x01


#define EMC_PID_REG 0xfd
#define EMC_VID_REG 0xfe
#define EMC_REV_REG 0xff
